<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Franklin Bristow" />
  <title>Shell scripts</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../styles.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>

<div id="main-outer-box">

<div id="my-header">
  <a href="../index.html">Introduction to Tools and Techniques in Computer Science</a>
</div>

<div id="trunk-box">

<div id="nav-box">
<p>Contents:</p>
<ul>
<li>Setup, writing structured text, and file management
<ul>
<li><a href=".././week02/topic-1.html">Introduction</a></li>
<li><a href=".././week02/topic-2.html">Installing software on your
personal computer</a></li>
<li><a href=".././week02/topic-3.html">Write plain text
documents</a></li>
<li><a href=".././week02/topic-4.html">Converting documents to different
formats</a></li>
<li><a href=".././week02/topic-5.html">Organizing your files</a></li>
<li><a href=".././week02/topic-6.html">Summary</a></li>
</ul></li>
<li>Remote connections and command-line file management
<ul>
<li><a href=".././week03/topic-0.html">Introduction</a></li>
<li><a href=".././week03/topic-1.html">Connecting to a remote
computer</a></li>
<li><a href=".././week03/topic-2.html">Command line file
management</a></li>
<li><a href=".././week03/topic-3.html">Command line text
editing</a></li>
<li><a href=".././week03/topic-4.html">Tab completion</a></li>
<li><a href=".././week03/topic-5.html">Transferring files</a></li>
<li><a href=".././week03/topic-6.html">handin</a></li>
<li><a href=".././week03/topic-7.html">Summary</a></li>
</ul></li>
<li>Compiling and running code, version control
<ul>
<li><a href=".././week04/topic-1.html">Introduction</a></li>
<li><a href=".././week04/topic-2.html">Compiling and running
code</a></li>
<li><a href=".././week04/topic-3.html">Version Control</a></li>
<li><a href=".././week04/topic-4.html">Summary</a></li>
</ul></li>
<li>Advanced version control, project management
<ul>
<li><a href=".././week05/topic-1.html">Introduction</a></li>
<li><a href=".././week05/topic-2.html">Advanced version control</a></li>
<li><a href=".././week05/topic-3.html">Managing personal
projects</a></li>
<li><a href=".././week05/topic-4.html">Summary</a></li>
</ul></li>
<li>Advanced shell usage
<ul>
<li><a href=".././week06/topic-1.html">Introduction</a></li>
<li><a href=".././week06/topic-2.html">Finding files</a></li>
<li><a href=".././week06/topic-3.html">Filtering lines</a></li>
<li><a href=".././week06/topic-4.html">Reading and changing
permissions</a></li>
<li><a href=".././week06/topic-5.html">Comparing plain text
files</a></li>
<li><a href=".././week06/topic-6.html">Summary</a></li>
</ul></li>
<li>Digital notebooks and getting help
<ul>
<li><a href=".././week07/topic-1.html">Introduction</a></li>
<li><a href=".././week07/topic-2.html">Getting help</a></li>
<li><a href=".././week07/topic-3.html">Getting help ‚Äî Examples</a></li>
<li><a href=".././week07/topic-4.html">Academic misconduct</a></li>
<li><a href=".././week07/topic-5.html">Digital notebooks</a></li>
<li><a href=".././week07/topic-6.html">Summary</a></li>
</ul></li>
<li>Debugging (strategies and usage)
<ul>
<li><a href=".././week08/topic-1.html">Introduction</a></li>
<li><a href=".././week08/topic-2.html">What even is debugging?</a></li>
<li><a href=".././week08/topic-3.html">Debugging strategies</a></li>
<li><a href=".././week08/topic-4.html">Debuggers</a></li>
<li><a href=".././week08/topic-5.html">Visual Debuggers</a></li>
<li><a href=".././week08/topic-6.html">Command-line Debuggers</a></li>
<li><a href=".././week08/topic-7.html">Summary</a></li>
</ul></li>
<li>Command-line environment
<ul>
<li><a href="topic-1.html">Introduction</a></li>
<li><a href="topic-2.html">Input and output on the command line</a></li>
<li><a href="topic-3.html">Redirecting input and output</a></li>
<li><a href="topic-4.html">Piping</a></li>
<li><strong>Shell scripts</strong></li>
<li><a href="topic-6.html">Summary</a></li>
</ul></li>
<li>Build systems and dependency management
<ul>
<li><a href=".././week10/topic-1.html">Introduction</a></li>
<li><a href=".././week10/topic-2.html">Programs requiring
dependencies</a></li>
<li><a href=".././week10/topic-3.html">Create a Makefile</a></li>
<li><a href=".././week10/topic-4.html">Build and dependency
management</a></li>
<li><a href=".././week10/topic-5.html">Summry</a></li>
</ul></li>
<li>Containers, virtual machines, and ‚ÄúThe Cloud ‚Ñ¢‚Äù
<ul>
<li><a href=".././week11/topic-1.html">Introduction</a></li>
<li><a href=".././week11/topic-2.html">Install and configure a virtual
machine</a></li>
<li><a href=".././week11/topic-3.html">Download and use a pre-installed
OS in VM software</a></li>
<li><a href=".././week11/topic-4.html">Run a command within a
container</a></li>
<li><a href=".././week11/topic-5.html">Initialize a server in a public
cloud</a></li>
<li><a href=".././week11/topic-6.html">Summary</a></li>
<li><a href=".././week11/hello-pandocker.html">Hello,
Pandocker!</a></li>
</ul></li>
<li>Backups
<ul>
<li><a href=".././week12/topic-1.html">Introduction</a></li>
<li><a href=".././week12/topic-2.html">Choose a backup strategy</a></li>
<li><a href=".././week12/topic-3.html">Install and configure back up
software</a></li>
<li><a href=".././week12/topic-4.html">Summary</a></li>
</ul></li>
<li>Running your own Linux system
<ul>
<li><a href=".././week13/topic-1.html">Introduction</a></li>
<li><a href=".././week13/topic-2.html">Choose a Linux
distribution</a></li>
<li><a href=".././week13/topic-3.html">Install a Linux
distribution</a></li>
<li><a href=".././week13/topic-4.html">Install packages</a></li>
<li><a href=".././week13/topic-5.html">Configure and run a web
server</a></li>
<li><a href=".././week13/topic-6.html">Summary</a></li>
</ul></li>
<li><a href=".././README.html">About this book</a></li>
</ul>

</div>

<div id="article-box">

<div id="header-nav-bar">
<div><a href="topic-4.html">‚Üêprev</a></div><div class="nav-bar-push"><a href="topic-6.html">next‚Üí</a></div>
</div>

<div id="article-content">
<header id="title-block-header">
<h1 class="title">Shell scripts</h1>
<p class="author">Franklin Bristow</p>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#shell-scripts" id="toc-shell-scripts">Shell scripts</a>
<ul>
<li><a href="#shells-and-languages" id="toc-shells-and-languages">Shells
and languages</a></li>
<li><a href="#basic-scripting" id="toc-basic-scripting">Basic
scripting</a>
<ul>
<li><a href="#general-structure" id="toc-general-structure">General
structure</a></li>
<li><a href="#simple-scripts" id="toc-simple-scripts">Simple
scripts</a></li>
</ul></li>
<li><a href="#environment-variables-and-the-path"
id="toc-environment-variables-and-the-path">Environment variables and
the <code>$PATH</code></a></li>
<li><a href="#arguments" id="toc-arguments">Arguments</a></li>
<li><a href="#structures-conditional-statements-and-loops"
id="toc-structures-conditional-statements-and-loops">Structures:
conditional statements and loops</a>
<ul>
<li><a href="#conditional-statements"
id="toc-conditional-statements">Conditional statements</a></li>
<li><a href="#loops" id="toc-loops">Loops</a></li>
</ul></li>
<li><a href="#further-reading" id="toc-further-reading">Further
reading</a></li>
</ul></li>
</ul>
</nav>
<h1 id="shell-scripts">Shell scripts</h1>
<div class="outcomes">
<ul class="task-list">
<li><input type="checkbox" checked="" />Write and run shell scripts to
repeat complex tasks.</li>
</ul>
</div>
<div style="float: left;width: 300px">
<figure>
<img src="script.png" alt="A script." />
<figcaption aria-hidden="true">A script.</figcaption>
</figure>
</div>
<p>At this point you‚Äôre pretty familiar with using the command line; you
should be able to do a variety of things:</p>
<ul>
<li>Navigate and create folder structures.</li>
<li>Edit text files.</li>
<li>Convert files between various formats.</li>
<li>Filter lines from text files.</li>
<li>Read and change permissions on files.</li>
<li>Use version control software.</li>
<li>Find files by name or properties.</li>
<li>Redirect standard input, output, and error.</li>
<li>Construct pipelines of commands.</li>
</ul>
<p>While there‚Äôs a whole world of things you can still learn about using
the command line, and more command line tools than you can imagine to
learn about (which sometimes themselves contain entire programming
languages!), you‚Äôve learned and demonstrated a lot! <span class="emoji"
data-emoji="tada">üéâ</span></p>
<p>As you‚Äôre getting more used to using the command line, you may find
yourself repeating similar, complex commands over and over again. Or
maybe you find yourself doing the same kinds of things over and over
again, maybe running multiple commands repeatedly. Or maybe you‚Äôve built
a complex pipeline that you want to keep for use later because you‚Äôll
need to use it again.</p>
<p>In their very simplest form, shell scripts are plain text files that
contain a sequence of commands or statements, separated by newlines or
semi-colons. As you grow shell scripts, they can contain things like
conditional statements, loops, functions, and‚Ä¶ uh, hey, <a
href="https://youtu.be/g3YiPC91QUk?t=58">wait a minute</a>. That, uh,
that sounds an awful lot like programming.</p>
<p>Most of the time we spend interacting with shells is interactive: the
shell is waiting for us to enter a command, and when we press
<kbd>Enter</kbd>, the shell runs the command, waits for it to finish (it
actually <code>wait(2)</code>s, it‚Äôs a C function), then patiently waits
for us to enter another command.</p>
<p>Most shells can also run non-interactively: you give the shell the
name of a file that contains a sequence of commands and the shell will
just interpret, then run the sequence of commands like it‚Äôs a
program.</p>
<h2 id="shells-and-languages">Shells and languages</h2>
<p>Similar to different programming languages, different shells use
different syntax to express similar ideas. Deciding which shell program
to use defines what syntax you‚Äôre going to use and the kinds of keywords
you should be using when you‚Äôre looking for help (in the manual page for
the shell, on the shell‚Äôs website, or generally online).</p>
<p>While your default shell on Aviary is <code>tcsh</code>, we‚Äôre going
to be using <code>bash</code> as a shell interpreter for scripting. This
is an opinionated choice, just as using <code>vim</code> instead of
<code>emacs</code> is an opinionated choice. As you get more comfortable
using the command line, you may want to choose a different shell (like
<code>fish</code>) and thus a different shell language, but
<code>bash</code> and its syntax are common enough that we‚Äôll treat it
like a ‚Äú<a href="https://en.wikipedia.org/wiki/Lingua_franca">lingua
franca</a>‚Äù.</p>
<h2 id="basic-scripting">Basic scripting</h2>
<p>Let‚Äôs start with the basics: the general structure of a shell script
and some very simple shell scripts.</p>
<h3 id="general-structure">General structure</h3>
<p>Shell scripts all start with a ‚Äú<a
href="https://en.wikipedia.org/wiki/Shebang_(Unix)">shebang</a>‚Äù line ‚Äî
a line that starts with the symbols <code>#!</code>. The first line
indicates which program is going to be run to interpret the rest of the
file.</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env bash # this is a bash script</span></span></code></pre></div>
<p>Everything after the first line is the actual contents of the script,
the sequence of commands to be executed.</p>
<h3 id="simple-scripts">Simple scripts</h3>
<p>Here‚Äôs an example of a very simple script:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env bash</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-la</span></span></code></pre></div>
<p>Copy and paste this into a new plain text file on Aviary; give it a
file name that represents what this does (I recommend <code>la</code>,
‚Äúlist all‚Äù).</p>
<div class="aside">
<p>Copying and pasting into <code>vim</code> is tedious, having to enter
and exit paste mode is a real bother. Another way to quickly copy and
paste into your terminal to create a new file is using the program
<code>cat</code>. As above, <code>cat</code> is a program that will read
standard input and write to standard output. But we can redirect
standard output to a file!</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> <span class="op">&gt;</span> la</span></code></pre></div>
<p>Once you enter that, press <kbd>Enter</kbd>, then paste, then press
<kbd>Control</kbd>+<kbd>D</kbd>.</p>
<p>That‚Äôs it!</p>
</div>
<p>Once you‚Äôve written the file, exit your editor. Before we can run a
shell script, we need to mark it as executable using
<code>chmod</code>:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chmod</span> a+x la</span></code></pre></div>
<p>Then we can run the script:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">./la</span></span></code></pre></div>
<p><span class="emoji" data-emoji="tada">üéâ</span>, your first shell
script!</p>
<p>Shell scripts consist of one or more lines of commands to run. Add
another line to your script:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">find</span> . <span class="at">-name</span> <span class="st">&quot;*.md&quot;</span></span></code></pre></div>
<p>Then run it again (you don‚Äôt need to <code>chmod</code> again). Now
<em>two</em> commands worth of output appear.</p>
<p>One command that you might find helpful when you‚Äôre scripting is the
<code>echo</code> command, this is a ‚Äúprint‚Äù command for shells:</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Hello, world!&quot;</span></span></code></pre></div>
<p>You can also write comments using the <code>#</code> symbol, anything
following is a comment:</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Hello, world&quot;</span> <span class="co"># a friendly message</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">find</span> . <span class="at">-name</span> <span class="st">&quot;*.docx&quot;</span> <span class="at">-delete</span> <span class="co"># clean up Word files</span></span></code></pre></div>
<div class="example">
<p>Here‚Äôs a more complete (and completely contrived) example of a
script:</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env bash</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Here&#39;s what&#39;s in the current directory:&quot;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># list all with long listings</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-al</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Here are all the Markdown files:&quot;</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># find all files with the `.md` extension</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="fu">find</span> . <span class="at">-name</span> <span class="st">&quot;*.md&quot;</span></span></code></pre></div>
</div>
<h2 id="environment-variables-and-the-path">Environment variables and
the <code>$PATH</code></h2>
<p>Shell languages, like other programming languages, support
variables.</p>
<p>Almost all shells follow the same convention for naming
variables:</p>
<ul>
<li>Variable names start with a <code>$</code>,</li>
<li>Variable names are all <code>UPPERCASE</code>,</li>
<li>Variable names are <a
href="https://en.wikipedia.org/wiki/Snake_case"><code>SNAKE_CASE</code></a>
(they use underscores to separate words).</li>
</ul>
<p>All shells have special variables, and those special variables help
your shell make decisions, or help define the behaviour that your shell
has. These special variables are called ‚Äúenvironment variables‚Äù.</p>
<div class="example">
<p>Try running this in your shell to find out what shell you‚Äôre
using:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$SHELL</span></span></code></pre></div>
<p><code>$SHELL</code> is an environment variable that contains the name
of the running shell.</p>
</div>
<p>When you enter the names of programs on the command line, your shell
has to figure out where that program actually is in a folder
structure.</p>
<div class="aside">
<p>This is might seem obvious when you think about it, but think about
it: the programs that you‚Äôre running on the command line are just files
with bits in them. They were written in a programming language (often
C), then compiled and put in a folder somewhere.</p>
<p>A lot of programs on Linux and UNIX systems live in the folders
<code>/bin</code> and <code>/usr/bin</code>. You can learn a bit more
about where files live on a Linux system by reading a manual page:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">man</span> hier </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">### OR</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">man</span> 7 hier <span class="co"># hier is in section 7 for miscellaneous</span></span></code></pre></div>
</div>
<p>Your shell uses a special environment variable called
<code>$PATH</code> (often called <em>the</em> <code>$PATH</code>) to
find where the command you just entered exists as a file. The
<code>$PATH</code> contains a list of directories that your shell will
look in to find the file representing the command you asked it to run.
Different shells use different separators for directory entries in the
path. Both <code>tcsh</code> and <code>bash</code> use a colon
<code>:</code> to separate directories.</p>
<div class="example">
<p>As above, use the <code>echo</code> command to print out what the
<code>$PATH</code> is right now in your shell:</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$PATH</span></span></code></pre></div>
</div>
<p>Your <code>$PATH</code> will contain many folders on Aviary, but it
importantly includes two directories:</p>
<ol type="1">
<li><code>.</code>: the current directory, and this is why you don‚Äôt
have to type <code>./</code> in front of programs you‚Äôve written and
compiled yourself.</li>
<li><code>~/bin</code>: a directory named <code>bin</code> relative to
your home directory. When you <code>echo $PATH</code>, the
<code>~</code> will be listed as an absolute path (e.g.,
<code>/home/student/you/bin</code>).</li>
</ol>
<p>What this means is that we can put scripts we write into the
directory <code>~/bin</code>, then we can run them
<em>anywhere</em>.</p>
<div class="example">
<p>The directory <code>~/bin</code> <em>may not</em> exist in your user
directory on Aviary. Create the directory, then move the <code>la</code>
script you wrote above into this directory.</p>
<p>This applies <strong>only</strong> to <code>tcsh</code>:
<code>tcsh</code> <a
href="https://en.wikipedia.org/wiki/Cache_(computing)">caches</a> the
names of commands that are in folders on the <code>$PATH</code>. After
you add something to <code>~/bin</code> (which is on your
<code>$PATH</code>), you‚Äôve got to get <code>tcsh</code> to regenerate
this cache. You can regenerate the cache in <code>tcsh</code> by running
the command:</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="ex">rehash</span></span></code></pre></div>
<p>You must do this any time you add programs or commands to folders on
the <code>$PATH</code> that you want to work in other places, but this
only applies to <code>tcsh</code>. If you‚Äôre using a different shell
like <code>bash</code> or <code>fish</code>, then your shell will almost
certainly do this for you.</p>
<p>Now change back to your user directory:</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ~</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">### Or just `cd` with no arguments</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span></span></code></pre></div>
<p>And run <code>la</code>. <span class="emoji"
data-emoji="tada">üéâ</span>, now you can run <code>la</code> in
<em>any</em> directory.</p>
</div>
<p>You can find out which environment variables are currently set and
what their values are using the <code>env</code> command.</p>
<h2 id="arguments">Arguments</h2>
<p>Shell scripts that you write can accept arguments, just like programs
you write in other programming languages. In both C and Java (and
Python, technically), you can access arguments passed on the command
line to your program as arrays of strings.</p>
<p>Shell scripts can access command line arguments using variables, but
you can directly access arguments on the command line as numbered
variables like <code>$1</code>.</p>
<div class="example">
<p>Here‚Äôs a small program that will print out the values passed to it as
arguments on the command line:</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env bash</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;The first argument is </span><span class="va">$1</span><span class="st">&quot;</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;The second argument is </span><span class="va">$2</span><span class="st">&quot;</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;The third argument is </span><span class="va">$3</span><span class="st">&quot;</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;All arguments are </span><span class="va">$*</span><span class="st">&quot;</span></span></code></pre></div>
<p>Write this script and try running it with different arguments to see
how the output changes. Don‚Äôt forget to use <code>chmod</code> to set
execute permissions for your script!</p>
</div>
<p>A common use of arguments on the command line for shell scripts is to
pass the name of a file or directory you want to operate on.</p>
<div class="example">
<p>Let‚Äôs upgrade our <code>la</code> script a little bit.</p>
<p>Remember that <code>ls</code> can run with no arguments, and when run
with no arguments it‚Äôs defaulting to printing out the contents of the
directory <code>.</code>. But <code>ls</code> <em>can</em> accept
arguments. Our <code>la</code> script doesn‚Äôt right now.</p>
<p>Change your <code>la</code> script to accept an argument and pass it
to <code>ls</code>:</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env bash</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-al</span> <span class="st">&quot;</span><span class="va">$1</span><span class="st">&quot;</span> <span class="co"># quotes in case of spaces!</span></span></code></pre></div>
<p>Now run <code>la</code> again, but pass it an argument:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="ex">la</span> .</span></code></pre></div>
<p>Neat.</p>
<div class="aside">
<p>Why ‚Äúquotes in case of spaces‚Äù? Try this:</p>
<ol type="1">
<li>Remove the quotes around <code>$1</code> in your script.</li>
<li>Create a directory that has a space in its name
(<code>mkdir "space dir"</code>).</li>
<li>Try running <code>la "space dir"</code>.</li>
<li>Put back the quotes around <code>$1</code> in your script.</li>
</ol>
<p>When the shell ‚Äúexpands‚Äù the variable <code>$1</code>, it‚Äôs replacing
the value of that variable into the command <em>literally</em>. If the
variable contains spaces, it will be replaced in the command spaces and
all. In other words,</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-al</span> <span class="va">$1</span> <span class="co"># becomes:</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-al</span> space dir</span></code></pre></div>
<p>If you remember <em>way back a long time ago</em>, we had to put
quotes around names with spaces when using <code>mkdir</code> because
<code>mkdir</code> would turn <code>space dir</code> into two
directories. Similarly, <code>ls</code> is looking for two separate
directories.</p>
<p>Including the quotes around <code>$1</code> makes sure that even if
the variable contains spaces, it‚Äôs going to be quoted when it‚Äôs passed
to the command:</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-al</span> <span class="st">&quot;</span><span class="va">$1</span><span class="st">&quot;</span> <span class="co"># becomes</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-al</span> <span class="st">&quot;space dir&quot;</span></span></code></pre></div>
</div>
</div>
<p>While we‚Äôve improved <code>la</code> slightly here, we‚Äôve also broken
it. Try running <code>la</code> by itself with no arguments.</p>
<p>‚Ä¶</p>
<p>Oops. Now we need to test for the special case of no arguments being
passed. We‚Äôre going to need some more tools for that: conditional
statements.</p>
<h2 id="structures-conditional-statements-and-loops">Structures:
conditional statements and loops</h2>
<p>Shell scripting languages are fully featured programming languages
and include structures like conditional statements and loops. They
contain other structures, too, but let‚Äôs stick to the basics.</p>
<h3 id="conditional-statements">Conditional statements</h3>
<p>Conditional statements in <code>bash</code> use the familiar
<code>if</code> keyword and <em>resemble</em> the expressions you‚Äôve
seen in other languages.</p>
<p>One of the major differences in <code>bash</code> are expressions
themselves: most of the questions you‚Äôre going to be asking about a
variable use unary operators.</p>
<p>Here‚Äôs what a <code>bash</code> conditional statement looks like:</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">[[</span> <span class="ot">-a</span> hello.c <span class="kw">]];</span> <span class="cf">then</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;hello.c exists&quot;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;hello.c does not exist&quot;</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span></code></pre></div>
<p>The <code>-a</code> is a unary operator on file names.
<code>-a</code> returns true if the file exists, and returns false if
the file does not exist.</p>
<p>Spacing is important here! <code>bash</code> is not a very smart
language. You might be tempted to leave out spaces between
<code>[[</code> and <code>-a</code> or between <code>hello.c</code> and
<code>]]</code>, but you <strong>must</strong> have spaces between these
symbols.</p>
<div class="aside">
<p>WHY?!</p>
<p><code>bash</code> is, uh, weird. <code>[[</code> is technically a
command that takes arguments. The arguments the <code>[[</code> command
is getting in the above example are <code>-a</code>,
<code>hello.c</code>, and <code>]]</code>. The <code>;</code> is a line
separator (like in Python it‚Äôs optional, but can be used).</p>
<p>Yeah, weird.</p>
</div>
<p><code>bash</code> has many unary operators that you can use to test
files or variables. The one we care about right now is the
<code>-n</code> operator, asking if a string is non-zero in length.</p>
<div class="example">
<p>Let‚Äôs add a conditional statement to <code>la</code> to test for the
presence of arguments:</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env bash</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">[[</span> <span class="ot">-n</span> <span class="st">&quot;</span><span class="va">$1</span><span class="st">&quot;</span> <span class="kw">]]</span> <span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ls</span> <span class="at">-al</span> <span class="st">&quot;</span><span class="va">$1</span><span class="st">&quot;</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ls</span> <span class="at">-al</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span></code></pre></div>
</div>
<p>You can find more unary operators in <code>bash</code> by reading the
<code>CONDITIONAL EXPRESSIONS</code> section of its manual page, but
here are some examples:</p>
<table>
<colgroup>
<col style="width: 30%" />
<col style="width: 69%" />
</colgroup>
<thead>
<tr class="header">
<th>Operator</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>-a file</code></td>
<td>True if file exists.</td>
</tr>
<tr class="even">
<td><code>-d file</code></td>
<td>True if file exists and is a directory.</td>
</tr>
<tr class="odd">
<td><code>-r file</code></td>
<td>True if file exists and is readable.</td>
</tr>
<tr class="even">
<td><code>-s file</code></td>
<td>True if file exists and has a size greater than 0.</td>
</tr>
<tr class="odd">
<td><code>string1 == string2</code></td>
<td>True if the strings are equal.</td>
</tr>
</tbody>
</table>
<h3 id="loops">Loops</h3>
<p>We can‚Äôt talk about conditional statements without at least saying
something about loops!</p>
<p>Similar to conditional statements, loops use the familiar
<code>for</code> keyword. Bash also supports <code>while</code> and
<code>until</code> loops, but most of the time you‚Äôre using a loop in
Bash, you‚Äôre operating on some sequence of file names rather than until
some event happens.</p>
<p>The structure of a <code>for</code> loop is frustratingly different
from conditional statements in a way it‚Äôs not in other programming
languages ‚Äî the conditional statements you saw above use the
<code>[[</code> and <code>]]</code> brackets for wrapping the
expression, but <code>for</code> loops generally do not use brackets or
parenthesis in Bash.</p>
<p>Here‚Äôs what a <code>for</code> loop looks like in Bash:</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> f <span class="kw">in</span> <span class="pp">*</span> <span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="va">$f</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
<ul>
<li>The <code>for</code> is ‚Ä¶ <code>for</code>, it‚Äôs the start of the
loop.</li>
<li>The <code>f</code> is the name of the variable you want to use as
the name for the value in the current iteration of the loop over the
sequence.</li>
<li>The <code>in</code> is a separator between the variable name and the
sequence.</li>
<li>In this case <code>*</code> <em>is</em> the sequence. This is a
‚Äúglob‚Äù or a pattern, and this glob in the shell means ‚Äúall files in the
current directory‚Äù.</li>
<li>The semi-colon <code>;</code>, like in conditional statements above,
ends the current statement.</li>
<li><code>do</code>, then is the beginning of the body of the loop.
<ul>
<li><code>echo $f</code> is one command you want run on the variable.
This will print out the variable‚Äôs name.</li>
</ul></li>
<li><code>done</code> ends the body of the loop.</li>
</ul>
<div class="aside">
<p>Maybe this looks sort of familiar. Maybe this looks like what we were
doing with <code>find</code> and <code>-exec</code>. They do accomplish
similar results!</p>
<p>Both work, and both are effective. One way to think about this
matching of ideas is that <code>find</code> and <code>-exec</code> are
more of a functional programming paradigm (this is a <code>map</code>
operation), <code>for</code> loops are more of a procedural
paradigm.</p>
</div>
<p>When you‚Äôre writing <code>for</code> loops, the sequence can either
use the patterns you‚Äôve seen before (like <code>*.md</code>), or can be
the result of a <em>command</em>.</p>
<p>In fact, we can rewrite the <code>for</code> loop from above using
<code>find</code>!</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> f <span class="kw">in</span> <span class="va">$(</span><span class="fu">find</span> . <span class="at">-maxdepth</span> 1<span class="va">)</span> <span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="va">$f</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
<p>The output looks a little bit different, but the result is the
same.</p>
<p>Another common kind of loop you may want to write is one that
iterates over a sequence of numbers (like the traditional
<code>for</code> loop you‚Äôve seen in languages like Java). To do that
you can use the <code>seq</code> command:</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> num <span class="kw">in</span> <span class="va">$(</span><span class="fu">seq</span> 1 10<span class="va">)</span> <span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="va">$num</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
<h2 id="further-reading">Further reading</h2>
<p>Just like programming, shell scripting goes way beyond what you‚Äôve
been introduced to here. You‚Äôve got a good start, but as you keep
working with shell scripting, you‚Äôll find yourself running into
situations where you need to get some more help.</p>
<ul>
<li>You can read the manual page for your shell to learn more about its
scripting language (e.g., <code>man bash</code> or
<code>man tcsh</code>).
<ul>
<li>Sections of interest in the manual page for <code>bash</code>
include the <code>CONDITIONAL EXPRESSIONS</code> section and the
<code>Compound Commands</code> subsection.</li>
</ul></li>
<li>Joshua Levy‚Äôs ‚Äú<a
href="https://github.com/jlevy/the-art-of-command-line">The Art of
Command Line</a>‚Äù is a very good resource that‚Äôs been translated into
many languages. It‚Äôs a good reference to keep in your bookmarks.</li>
<li><a href="https://www.shellcheck.net/">ShellCheck</a> is a tool for
identifying and then helping you fix possible bugs in your shell
scripts.</li>
<li>The <a href="https://tldp.org/LDP/abs/html/">Advanced Bash-Scripting
Guide</a> is a comprehensive guide for shell scripting with Bash.</li>
</ul>

</div> <!-- article-content -->

<div id="footer-nav-bar">
<div><a href="topic-4.html">‚Üêprev</a></div><div class="nav-bar-push"><a href="topic-6.html">next‚Üí</a></div>
</div>

</div> <!-- article-box -->

</div> <!-- trunk-box -->

<div id="my-footer">
&copy; Franklin Bristow 2022 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a><br/>
<a href="topic-5.md">Pandoc-Markdown source for this page</a><br/>
(Docs processed by
<a href="http://www.unexpected-vortices.com/sw/rippledoc/index.html">Rippledoc</a>.)
</div> <!-- my-footer -->

</div> <!-- main-outer-box -->

</body>
</html>
