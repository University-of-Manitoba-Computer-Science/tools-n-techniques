<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Franklin Bristow" />
  <title>Filter lines from large text files</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../styles.css" />
</head>
<body>

<div id="main-outer-box">

<div id="my-header">
  <a href="../index.html">Introduction to Tools and Techniques in Computer Science</a>
</div>

<div id="trunk-box">

<div id="nav-box">
<p>Contents:</p>
</details>
<details>
<summary>
Setup, writing structured text, and file management
</summary>
<ul>
<li><a href=".././topic01/topic-1.html">Introduction</a></li>
<li><a href=".././topic01/topic-2.html">Installing software on your
personal computer</a></li>
<li><a href=".././topic01/topic-3.html">Write plain text
documents</a></li>
<li><a href=".././topic01/topic-4.html">Converting documents to
different formats</a></li>
<li><a href=".././topic01/topic-5.html">Organizing your files</a></li>
<li><a href=".././topic01/topic-6.html">Summary</a></li>
</ul>
</details>
<details>
<summary>
Remote connections and command-line file management
</summary>
<ul>
<li><a href=".././topic02/topic-0.html">Introduction</a></li>
<li><a href=".././topic02/topic-1.html">Connecting to a remote
computer</a></li>
<li><a href=".././topic02/topic-2.html">Command line file
management</a></li>
<li><a href=".././topic02/topic-3.html">Command line text
editing</a></li>
<li><a href=".././topic02/topic-4.html">Tab completion</a></li>
<li><a href=".././topic02/topic-5.html">Transferring files</a></li>
<li><a href=".././topic02/topic-6.html">handin</a></li>
<li><a href=".././topic02/topic-7.html">Summary</a></li>
</ul>
</details>
<details>
<summary>
Compiling and running code, version control
</summary>
<ul>
<li><a href=".././topic03/topic-1.html">Introduction</a></li>
<li><a href=".././topic03/topic-2.html">Compiling and running
code</a></li>
<li><a href=".././topic03/topic-3.html">Version Control</a></li>
<li><a href=".././topic03/topic-4.html">Summary</a></li>
</ul>
</details>
<details>
<summary>
Advanced version control, project management
</summary>
<ul>
<li><a href=".././topic04/topic-1.html">Introduction</a></li>
<li><a href=".././topic04/topic-2.html">Advanced version
control</a></li>
<li><a href=".././topic04/topic-3.html">Managing personal
projects</a></li>
<li><a href=".././topic04/topic-4.html">Summary</a></li>
</ul>
</details>
<details open>
<summary>
Advanced shell usage
</summary>
<ul>
<li><a href="topic-1.html">Introduction</a></li>
<li><a href="topic-2.html">Finding files</a></li>
<li><strong>Filter lines from large text files</strong></li>
<li><a href="topic-4.html">Reading and changing permissions</a></li>
<li><a href="topic-5.html">Comparing plain text files</a></li>
<li><a href="topic-6.html">Summary</a></li>
</ul>
</details>
<details>
<summary>
Digital notebooks and getting help
</summary>
<ul>
<li><a href=".././topic06/topic-1.html">Introduction</a></li>
<li><a href=".././topic06/topic-2.html">Getting help</a></li>
<li><a href=".././topic06/topic-3.html">Getting help ‚Äî Examples</a></li>
<li><a href=".././topic06/topic-4.html">Academic misconduct</a></li>
<li><a href=".././topic06/topic-5.html">Digital notebooks</a></li>
<li><a href=".././topic06/topic-6.html">Summary</a></li>
</ul>
</details>
<details>
<summary>
Debugging (strategies and usage)
</summary>
<ul>
<li><a href=".././topic07/topic-1.html">Introduction</a></li>
<li><a href=".././topic07/topic-2.html">What even is debugging?</a></li>
<li><a href=".././topic07/topic-3.html">Debugging strategies</a></li>
<li><a href=".././topic07/topic-4.html">Debuggers</a></li>
<li><a href=".././topic07/topic-5.html">Visual Debuggers</a></li>
<li><a href=".././topic07/topic-6.html">Command-line Debuggers</a></li>
<li><a href=".././topic07/topic-7.html">Summary</a></li>
<li><a href=".././topic07/topic-8.html">Practice Questions</a></li>
</ul>
</details>
<details>
<summary>
Command-line environment
</summary>
<ul>
<li><a href=".././topic08/topic-1.html">Introduction</a></li>
<li><a href=".././topic08/topic-2.html">Input and output on the command
line</a></li>
<li><a href=".././topic08/topic-3.html">Redirecting input and
output</a></li>
<li><a href=".././topic08/topic-4.html">Piping</a></li>
<li><a href=".././topic08/topic-5.html">Choose a backup
strategy</a></li>
<li><a href=".././topic08/topic-6.html">Install and configure back up
software</a></li>
<li><a href=".././topic08/topic-7.html">Summary</a></li>
<li><a href=".././topic08/topic-8.html">Practice Questions</a></li>
</ul>
</details>
<details>
<summary>
Shell scripting
</summary>
<ul>
<li><a href=".././topic09/topic-1.html">Introduction</a></li>
<li><a href=".././topic09/topic-2.html">Shell scripts</a></li>
<li><a href=".././topic09/topic-3.html">Arguments</a></li>
<li><a href=".././topic09/topic-4.html">Structures: conditional
statements and loops</a></li>
<li><a href=".././topic09/topic-5.html">Globs</a></li>
<li><a href=".././topic09/topic-6.html">Debugging shell scripts</a></li>
<li><a href=".././topic09/topic-7.html">Summary</a></li>
<li><a href=".././topic09/topic-8.html">Practice Questions</a></li>
</ul>
</details>
<details>
<summary>
Build systems and dependency management
</summary>
<ul>
<li><a href=".././topic10/topic-1.html">Introduction</a></li>
<li><a href=".././topic10/topic-2.html">Programs requiring
dependencies</a></li>
<li><a href=".././topic10/topic-3.html">Create a Makefile</a></li>
<li><a href=".././topic10/topic-4.html">Build and dependency
management</a></li>
<li><a href=".././topic10/topic-5.html">Summary</a></li>
</ul>
</details>
<details>
<summary>
Containers, virtual machines, and ‚ÄúThe Cloud ‚Ñ¢‚Äù
</summary>
<ul>
<li><a href=".././topic11/topic-1.html">Introduction</a></li>
<li><a href=".././topic11/topic-2.html">Install and configure a virtual
machine</a></li>
<li><a href=".././topic11/topic-3.html">Download and use a pre-installed
OS in VM software (VirtualBox)</a></li>
<li><a href=".././topic11/topic-4.html">Download and use a pre-installed
OS in VM software (UTM)</a></li>
<li><a href=".././topic11/topic-5.html">Run a command within a
container</a></li>
<li><a href=".././topic11/topic-6.html">Initialize a server in a public
cloud</a></li>
<li><a href=".././topic11/hello-pandocker.html">Hello,
Pandocker!</a></li>
<li><a href=".././topic11/topic-7.html">Summary</a></li>
</ul>
</details>
<details>
<summary>
Running your own Linux system
</summary>
<ul>
<li><a href=".././topic12/topic-1.html">Introduction</a></li>
<li><a href=".././topic12/topic-2.html">Choose a Linux
distribution</a></li>
<li><a href=".././topic12/topic-3.html">Install a Linux
distribution</a></li>
<li><a href=".././topic12/topic-4.html">Install packages</a></li>
<li><a href=".././topic12/topic-5.html">Configure and run a web
server</a></li>
<li><a href=".././topic12/topic-6.html">Summary</a></li>
<li><a href=".././README.html">About this book</a></li>
</ul>

</div>

<div id="article-box">

<div id="header-nav-bar">
<div><a href="topic-2.html">‚Üêprev</a></div><div class="nav-bar-push"><a href="topic-4.html">next‚Üí</a></div>
</div>

<div id="article-content">
<header id="title-block-header">
<h1 class="title">Filter lines from large text files</h1>
<p class="author">Franklin Bristow</p>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#getting-some-data" id="toc-getting-some-data">Getting some
data</a></li>
<li><a href="#basic-use" id="toc-basic-use">Basic use</a></li>
<li><a href="#counting-lines" id="toc-counting-lines">Counting
lines</a></li>
<li><a href="#showing-lines-around-the-matching-lines"
id="toc-showing-lines-around-the-matching-lines">Showing lines around
the matching lines</a></li>
<li><a href="#filtering-recursively"
id="toc-filtering-recursively">Filtering recursively</a></li>
<li><a href="#printing-matching-line-numbers"
id="toc-printing-matching-line-numbers">Printing matching line
numbers</a></li>
</ul>
</nav>
<div class="outcomes">
<ul class="task-list">
<li><label><input type="checkbox" checked="" />Filter lines from large
text files using patterns.</label></li>
</ul>
</div>
<p>We‚Äôre going to switch away from <code>find</code>, but we‚Äôre going to
stick with the general theme of using patterns. Another relatively
common task is to find lines <em>within</em> a plain text file that
match a certain pattern.</p>
<p>Depending on which courses you‚Äôre taking or have taken, this might be
a task where you would consider using a loop, but we‚Äôre going to take
advantage of a tool that‚Äôs available on the command line:
<code>grep</code>.</p>
<div class="aside">
<p>What on earth does <code>grep</code> mean?!</p>
<p>Computer Scientists and programmers are bad at naming things (maybe
because it‚Äôs a ‚Äú<a
href="https://www.martinfowler.com/bliki/TwoHardThings.html">hard
thing</a>‚Äù). Maybe it is hard, but we‚Äôre still bad at naming things, and
<a href="https://youtu.be/4mcD5jd-RAU?t=34">we should feel bad</a>.</p>
<p>I‚Äôm digressing. The name <code>grep</code> <a
href="https://en.wikipedia.org/wiki/Grep#History">comes from a command
in the <code>ed</code> editor</a> that would ‚Äú<strong>g</strong>lobally
search for a <strong>r</strong>egular <strong>e</strong>pression and
<strong>p</strong>rint matching lines‚Äù.</p>
<p>An unfortunate theme among useful programs in Unix and Unix-like
operating systems (like macOS and Linux) is that their names aren‚Äôt
<em>discoverable</em> (it‚Äôs really hard to figure out a command to do
something you want when it‚Äôs called something like
<code>grep</code>).</p>
</div>
<p>Just finding the lines that match a pattern in a file can be useful,
but we‚Äôre going to look at a few options for <code>grep</code> that can
help give some additional information or context about what we‚Äôre
looking for:</p>
<ul>
<li>Basic use: printing out matching lines.</li>
<li>An option to count the number of matching lines.</li>
<li>An option to show lines around the line we‚Äôre looking for.</li>
<li>An option to search files recursively.</li>
<li>An option to print the line number that matches the pattern.</li>
</ul>
<h1 id="getting-some-data">Getting some data</h1>
<p>Let‚Äôs start with a large text file.</p>
<div class="aside">
<p>The example we‚Äôre going to be using here is genetic sequence data.
Similar to how Computer Scientists and programmers are bad at naming
things, biologists and microbiologists are bad at storing things and
they use plain text formats to store genetic sequence data. That‚Äôs
actually really convenient for us because it gives a realistic data set
to work with.</p>
<p>Don‚Äôt worry: you don‚Äôt need to be a biologist or microbiologist to
follow along.</p>
</div>
<p>Download this file from <a
href="https://www.ncbi.nlm.nih.gov/">NCBI</a> to your user directory on
Aviary (use <code>wget</code> or <code>curl</code>):</p>
<p><a
href="https://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/030/370/485/GCA_030370485.1_ASM3037048v1/GCA_030370485.1_ASM3037048v1_genomic.fna.gz"
class="uri">https://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/030/370/485/GCA_030370485.1_ASM3037048v1/GCA_030370485.1_ASM3037048v1_genomic.fna.gz</a></p>
<p>This file type is a <code>gz</code> or ‚Äúg-zipped‚Äù file (where the g
means <a href="https://www.gnu.org/philosophy/free-sw.html">gnu</a>).
Once you‚Äôve downloaded the file, you will have to decompress it!</p>
<div class="columns">
<div class="column input" style="width:50%;">
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gunzip</span> GCA_030370485.1_ASM3037048v1_genomic.fna.gz</span></code></pre></div>
</div><div class="column output" style="width:50%;">
<p><code>gunzip</code> does not print any output, but you should now see
<code>GCA_030370485.1_ASM3037048v1_genomic.fna</code>, noting that the
<code>.gz</code> is not at the end of the file name any more.</p>
</div>
</div>
<p>Now that the file is decompressed, feel free to take a look at it
using your preferred text editor on Aviary (e.g., <code>vim</code>,
<code>nano</code>, <code>emacs</code>). This is a <a
href="https://en.wikipedia.org/wiki/FASTA_format">FASTA-formatted
file</a>. A FASTA-formatted file contains 1 or more ‚Äúrecords‚Äù, where a
record will have a unique identifier that‚Äôs meaningful to a biologist or
microbiologist, and then the sequence data that corresponds to that
identifier. Records look like this:</p>
<pre><code>&gt;OR160415.1 Monkeypox virus isolate hMpxV/USA/IL-RIPHL-MPXV-050-0057/2023, complete genome
TTACAGATCATTTATATTCCAAAAATATTAACTATATACGTTTATTATATGATGTTAACGTGTAAATTATAAACATTATT</code></pre>
<p>The file you just downloaded is about 200KB in size (there are about
200 thousand characters in this file), so doing things like counting
records is not something we want to do by hand.</p>
<h1 id="basic-use">Basic use</h1>
<div class="aside">
<p>You could do these exercises with any text file. Consider trying them
with some of the markdown files you‚Äôve created in the past, too!</p>
</div>
<p>Let‚Äôs start using <code>grep</code> to filter and print out lines
that match a certain pattern.</p>
<div class="example">
<p>From our crash course on FASTA-formatted files, we know that records
have unique identifiers, and the lines with unique identifiers contain
or start with the <code>&gt;</code> character. Let‚Äôs use that as our
filter:</p>
<div class="input">
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> <span class="st">&#39;&gt;&#39;</span> GCA_030370485.1_ASM3037048v1_genomic.fna <span class="co"># print all lines in the file that</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                                                  <span class="co"># contain the &gt; character</span></span></code></pre></div>
</div>
<p>This will print out a bunch of lines (we‚Äôll find out how many real
soon!), and all the lines contain the pattern <code>&gt;</code>.</p>
<p>We can actually be more precise with what we want by using an
‚Äúanchor‚Äù for our pattern. Records start with lines where the
<strong>first character</strong> on the line is <code>&gt;</code>. In
most FASTA-formatted files, the only place where the <code>&gt;</code>
character appears is on the unique identifier line, but it‚Äôs possible
for it to appear in other places, too.</p>
<div class="input">
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> <span class="st">&#39;^&gt;&#39;</span> GCA_030370485.1_ASM3037048v1_genomic.fna <span class="co"># print all lines in the file that</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                                                   <span class="co"># **start with** the &gt; character</span></span></code></pre></div>
</div>
<p>The <code>^</code> (caret, I prefer ‚Äúhat‚Äù) is an ‚Äúanchor‚Äù: ‚ÄúFrom the
start of the line‚Äù.</p>
</div>
<h1 id="counting-lines">Counting lines</h1>
<p>Seeing the lines that match the pattern is useful, but we may also
want to know other stuff, like how many lines matched the pattern.
Thankfully, <code>grep</code> has an option to help us with that:
<code>-c</code>.</p>
<div class="example">
<div class="input">
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> <span class="at">-c</span> <span class="st">&#39;^&gt;&#39;</span> GCA_030370485.1_ASM3037048v1_genomic.fna <span class="co"># count the lines in the file that</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                                                      <span class="co"># start with the &gt; character</span></span></code></pre></div>
</div>
<p>This prints out <em>only a number</em>, and the number represents how
many lines matched the pattern.</p>
<p>For <code>GCA_030370485.1_ASM3037048v1_genomic.fna</code>, this tells
us how many records are in this file.</p>
</div>
<h1 id="showing-lines-around-the-matching-lines">Showing lines around
the matching lines</h1>
<p>We can ask <code>grep</code> to find lines that match patterns, and
we can also ask <code>grep</code> to show us the lines that are around
(before and after) the line that matches the pattern. <code>grep</code>
calls this ‚Äúcontext‚Äù.</p>
<div class="example">
<p>We can print the lines that match the pattern, plus the lines
immediately after those using the <code>-A</code> option (after):</p>
<div class="input">
<div class="sourceCode" id="cb6"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> <span class="at">-A</span> 2 <span class="st">&#39;^&gt;&#39;</span> GCA_030370485.1_ASM3037048v1_genomic.fna <span class="co"># print out the record identifier and</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                                                        <span class="co"># 2 lines of sequence data after it.</span></span></code></pre></div>
</div>
<p>Similarly, we can print the lines that match the pattern, plus the
lines immediately <em>before</em> those using the <code>-B</code> option
(before):</p>
<div class="input">
<div class="sourceCode" id="cb7"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> <span class="at">-B</span> 2 <span class="st">&#39;^&gt;&#39;</span> GCA_030370485.1_ASM3037048v1_genomic.fna <span class="co"># print out the record identifier and</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                                                        <span class="co"># 2 lines of sequence data before it.</span></span></code></pre></div>
</div>
<p>We can do both at the same time with the <code>-C</code> option (this
is upper-case C, for ‚Äúcontext‚Äù):</p>
<div class="input">
<div class="sourceCode" id="cb8"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> <span class="at">-C</span> 2 <span class="st">&#39;^&gt;&#39;</span> GCA_030370485.1_ASM3037048v1_genomic.fna <span class="co"># print out the record identifier and both</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                                                        <span class="co"># 2 lines before and after it.</span></span></code></pre></div>
</div>
</div>
<h1 id="filtering-recursively">Filtering recursively</h1>
<p>Sometimes you want to search many files in the same directory for a
pattern, either because you don‚Äôt know which file contains the lines
you‚Äôre looking for, or because your data is spread across many
files.</p>
<p>We‚Äôve seen a ‚Äúrecursive‚Äù command before:</p>
<div class="input">
<div class="sourceCode" id="cb9"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> hello <span class="co"># recursively remove hello and everything within it</span></span></code></pre></div>
</div>
<p>The <code>grep</code> command also has a recursive option, and it‚Äôs
also <code>-r</code>!</p>
<div class="example">
<p>Switch back to <code>crazy-directories</code>. We were able to use
<code>find</code> to help us find files that have names matching a
pattern. Now we want to use <code>grep</code> to find files that contain
a specific pattern.</p>
<p>Emoji short codes all follow the same pattern: A colon, followed by
some characters, followed by another colon. Here are some emoji and
their <a
href="https://www.unicode.org/emoji/charts/full-emoji-list.html">short
codes</a>:</p>
<ul>
<li><code>:banana:</code> <span class="emoji"
data-emoji="banana">üçå</span></li>
<li><code>:robot:</code> <span class="emoji"
data-emoji="robot">ü§ñ</span></li>
<li><code>:sparkles:</code> <span class="emoji"
data-emoji="sparkles">‚ú®</span></li>
</ul>
<p>We can use <code>grep</code> recursively to find all files that
contain one or more lines matching the pattern <code>:*:</code> (a
colon, followed by any number of characters, followed by another
colon).</p>
<div class="input">
<div class="sourceCode" id="cb10"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> <span class="at">-r</span> <span class="st">&quot;:*:&quot;</span> <span class="co"># note no filename!</span></span></code></pre></div>
</div>
<p>Depending on the state you‚Äôre in, this is probably going to print out
a few more files than you expected, including <code>.docx</code>
files.</p>
<div class="aside">
<p>Let‚Äôs talk about what <code>.docx</code> files are: they‚Äôre secretly
a <code>.zip</code> file. Remember how to <code>unzip</code>
<code>.zip</code> files? That‚Äôs right! <code>unzip</code>!</p>
<p>Go ahead, change into a directory containing one of the
<code>.docx</code> files you created in <code>crazy-directories</code>
and <code>unzip</code> it:</p>
<div class="input">
<div class="sourceCode" id="cb11"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unzip</span> robot.md.docx</span></code></pre></div>
</div>
<p>There are going to be a bunch of new files in the directory that are
mostly <code>.xml</code> files. XML is a ‚Äúmarkup‚Äù language, sort of like
Markdown.</p>
<p>Try running <code>grep</code> again recursively on this again and
you‚Äôll see that we‚Äôre not just matching emoji short codes anymore, but a
bunch of weird looking XML. Neat <span class="emoji"
data-emoji="camera">üì∑</span>.</p>
</div>
</div>
<h1 id="printing-matching-line-numbers">Printing matching line
numbers</h1>
<p>Knowing the name of the file containing the line that matches your
pattern is often enough, but <code>grep</code> can help you out a little
more by telling you exactly the line number that matched the pattern.
You can ask <code>grep</code> to tell you this using the <code>-n</code>
option.</p>
<div class="example">
<p>If you left the root of <code>crazy-directories</code>, change back
to it.</p>
<p>Let‚Äôs find all files that contain the pattern <code>:*:</code> again,
but we‚Äôll ask for <code>grep</code> to print out the line numbers:</p>
<div class="input">
<div class="sourceCode" id="cb12"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> <span class="at">-rn</span> <span class="st">&quot;:*:&quot;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># OR</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> <span class="at">-r</span> <span class="at">-n</span> <span class="st">&quot;:*:&quot;</span></span></code></pre></div>
</div>
<p><em>Some</em> command line tools will allow you to combine options
after a single <code>-</code> (so <code>-r -n</code> turns into
<code>-rn</code>).</p>
</div>

</div> <!-- article-content -->

<div id="footer-nav-bar">
<div><a href="topic-2.html">‚Üêprev</a></div><div class="nav-bar-push"><a href="topic-4.html">next‚Üí</a></div>
</div>

</div> <!-- article-box -->

</div> <!-- trunk-box -->

<div id="my-footer">
&copy; Franklin Bristow and <a href="https://github.com/University-of-Manitoba-Computer-Science/tools-n-techniques/graphs/contributors">others</a> (2022, 2023, 2024) <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a><br/>
<a href="topic-3.md">Pandoc-Markdown source for this page</a><br/>
(Docs processed by
<a href="http://www.unexpected-vortices.com/sw/rippledoc/index.html">Rippledoc</a>.)
</div> <!-- my-footer -->

</div> <!-- main-outer-box -->

</body>
</html>
